### Resource Manager WARNING - Still not fully tested. 

**Resource Manager** is a flexible tool to control systemd services on Ubuntu servers. It exposes a REST API to list available services, check their statuses, and start/stop/enable/disable them. In addition, a Python client module is provided to easily integrate these functionalities into other projects.
WARNING: This is intended to facilitate development in homelab, local environments with multiple VMs or external servers but reachable via VPN and under your administration domain. The API has no access control! Do not expose it to the Internet!

## Repository Structure

```txt
resource_manager/
├── resource_manager/               # Client Python Package
│   ├── __init__.py                 # Exposes the client API 
│   └── client/
│       ├── __init__.py
│       └── resource_manager_client.py
└── server/                         # Server-related files
    ├── resource_manager_server.py  # The Flask-based API server
    ├── services_config.py          # Dictionary configuration (Auto-generated by install.sh)
    └── requirements.txt            # Server dependencies
```

## Installing and Running the Server

The server is intended to run as a systemd service on Ubuntu, managed by a dedicated non‑root user. The installation script automates the following tasks:

- Cloning the repository in a temp dir
- Creating the installation directory in `/opt/resource_manager`
- Copying the server files (the Flask-based API and requirements)
- Generating the `services_config.py` file based on the services provided as parameters
- Setting up a Python virtual environment and installing dependencies
- Creating a dedicated system user with limited sudo rights for controlling systemd services
- Creating the systemd unit file and enabling the service at boot

### Prerequisites

- Ubuntu (systemd)
- Git, curl, Python 3 (with venv support)
- Internet access for cloning the repo and installing Python packages

### Installation Instructions

If the server you want to manage resources on is not local, install on the server:

## Remote Server standalone installation: 

If the server will not be remote, skip this step to install it together with the module.
Run the following command as root (or via sudo), specifying one or more service names (the service names should correspond to your systemd unit files without the `.service` suffix). Below are 3 services as an example - this is actually how I'm using it and where the idea came from:

```bash
sudo apt install python3-venv curl
curl -sSL https://raw.githubusercontent.com/muriloat/resource_manager/refs/heads/main/server-install.sh | sudo bash -s letta ollama vllm comfyUI
```

*** Just a word of caution: Always review the script (or trust its source) before running it with elevated privileges.

## Client Python module:

# Option 1 - Git Repository:

Clone the repository into your project's root:

Client Python module:

```bash
git clone https://github.com/murilot/resource_manager.git
```

If you intend to manage your local server (where you are installing the module):

```bash
cd resource_manager
pip install .[server]
```

# Option 2 - pip install:

Install it as a package if desired (no PyPI!):

Client Python module:

```bash
pip install git+https://github.com/murilot/resource_manager.git
```

If you intend to manage your local server (where you are installing the module):

```bash
pip install 'git+https://github.com/murilot/resource_manager.git#egg=resource_manager[server]'
```

### Example Usage

After installing the client module, you can interact with the Resource Manager API as follows:

```python
from resource_manager_client import ResourceManagerClient

# Instantiate for each different server:
gpu_remote_server = ResourceManagerClient(base_url="http://192.168.1.100:5000")
local_server = ResourceManagerClient()

# List available local services
services = local_server.list_services()
print("Services:", services)

# Get status for a specific remote service
status = gpu_remote_server.get_service_status("ollama")
print("Ollama status:", status)

# Start a remote service
gpu_remote_server.start_service("vllm")

# Stop a remote service
gpu_remote_server.stop_service("vllm")
```

### Troubleshooting

Check if 'resource_manager' user really has sufficient permissions:

sudo -u resource_manager -s

TODO...

### It's not good, difficult to install, doesn't work, many bugs...

Send me a message and bless me with your criticisms <dev@murilo.etc.br> and run from your server:

```bash
sudo curl -sSL https://raw.githubusercontent.com/muriloat/resource_manager/refs/heads/main/server-uninstall.sh | bash
```

Just a word of caution: Always review the script (or trust its source) before running it with elevated privileges.

### Very good, works well, is simple and useful

Buy me a btcoffee! 38Sr6UFA6ZXDBq7UfSKXoj37ej53PF895z
